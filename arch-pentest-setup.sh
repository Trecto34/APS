#!/bin/bash

#--------------[ SCRIPT TO INSTALL COMMON PENTEST AND BUGBOUNTY TOOLS UNDER ARCHLINUX ]------------------
# By: @Trecto34 
# Original By: @Iann-Zorkot
# Usage: # bash ./arch-pentest-setup.sh
# Version: 1.3
#--------------------------------------------------------------------------------------------------------

# Path to the current directory
MY_DIR=$(pwd)

# backup /etc/pacman.conf
function backupPacConf {
    echo "Backing Up /etc/pacman.conf to /etc/pacman.conf.bkp"
    cp /etc/pacman.conf /etc/pacman.conf.bkp
}

# Add BlackArch repository
function addBlackArch {
    if sudo cat /etc/pacman.conf | grep -q "Include = /etc/pacman.d/blackarch-mirrorlist";
    then
        echo "BlackArch repo already installed";
    else
        cd /tmp && curl -O https://blackarch.org/strap.sh && chmod +x strap.sh && sh ./strap.sh;
        cd $MY_DIR;
    fi
}

# Add MultiLib repository
function addMultiLib {
    if sudo cat /etc/pacman.conf | grep -q "Include = /etc/pacman.d/mirrorlist";
    then
        echo "MultiLib repo already installed"
    else
        echo "[multilib]" >> /etc/pacman.conf
        echo "Include = /etc/pacman.d/mirrorlist"
    fi
}

# Install penetration testing tools
function installTools {
    # Install tools via Pacman
    pacman --noconfirm --disable-download-timeout -Sy amass wget python-pip nmap sqlmap rustscan feroxbuster burpsuite wireshark-qt nikto hashcat john metasploit tcpdump gnu-netcat hydra waybackurls gau anewer meg qsreplace httprobe assetfinder gf dnsx ffuf gobuster gospider hakrawler httpx metabigor subfinder wafw00f android-apktool secretfinder dalfox nuclei openvpn enum4linux

    # Install FuzzingTool via Pip
    pip3 install FuzzingTool

    # Install SecLists
    mkdir /usr/share/wordlists
    cd /usr/share/wordlists
    git clone https://github.com/danielmiessler/SecLists.git
    cd $MY_DIR
}

# Install extra tools
function installExtra {

    sudo bash ./extra.sh
}

function checkRoot {
    if [ $EUID != 0 ]
    then 
        echo "[-] This script can only be executed as root"
        exit
    fi
}

function usage {
    echo "
    Script for automatic installation of pentesting tools on Arch Linux

    Usage:
    Only add libs:
        ./arch-pentest-setup.sh -r

    Only install basic tools:
        ./arch-pentest-setup.sh -t

    Only instal extra tools:
        ./arch-pentest-setup.sh -e

    Do everything: 
        ./arch-pentest-setup.sh -a"
}

#=-=-=-=-=-=-=-=- MAIN -=-=-=-=-=-=--=-=-
cat <<EOI
 ▄▀▀█▄   ▄▀▀▄▀▀▀▄  ▄▀▀▀▀▄
▐ ▄▀ ▀▄ █   █   █ █ █   ▐
 █▄▄▄█ ▐  █▀▀▀▀     ▀▄
▄▀   █    █      ▀▄   █
█   ▄▀ ▄ ▄▀ ▄      █▀▀▀ ▄
▐   ▐   █          ▐
▐                 
V2.0
By: @Trecto34
EOI

checkRoot

while getopts "rtea" o; do
    case "${o}" in
        r) addBlackArch && addMultiLib;;
        t) addBlackArch && addMultiLib && installTools;;
        e) addBlackArch && addMultiLib && installExtra;;
        a) addBlackArch && addMultiLib && installTools && installExtra;;
        *) usage; exit 1;;
    esac
done
if [ $OPTIND -eq 1 ]; then
    usage; exit 1
fi
